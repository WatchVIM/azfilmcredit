<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AZ Film Credit | CPA-Ready Arizona Film Credit Package</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta
    name="description"
    content="Upload your Arizona production details and documents. AZ Film Credit prepares a CPA-ready audit package and filing forms for the Arizona film credit program."
  />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            desertGold: "#E3A857",
            sunsetRed: "#E4572E",
            deepSlate: "#111827",
            sand: "#F3F4F6"
          }
        }
      }
    }
  </script>

  <style>
    body {
      background: radial-gradient(circle at top, #111827 0, #020617 45%, #000000 100%);
      color: #F9FAFB;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    .glass { background: rgba(0,0,0,.55); backdrop-filter: blur(10px); }
  </style>
</head>

<body class="min-h-screen flex flex-col">

  <!-- HEADER -->
  <header class="border-b border-white/10 glass">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <svg class="w-9 h-9" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect x="2" y="4" width="36" height="32" rx="10" fill="#111827"/>
          <rect x="7" y="11" width="4" height="4" rx="1" fill="#F3F4F6"/>
          <rect x="7" y="19" width="4" height="4" rx="1" fill="#F3F4F6"/>
          <rect x="7" y="27" width="4" height="4" rx="1" fill="#F3F4F6"/>
          <rect x="29" y="11" width="4" height="4" rx="1" fill="#F3F4F6"/>
          <rect x="29" y="19" width="4" height="4" rx="1" fill="#F3F4F6"/>
          <rect x="29" y="27" width="4" height="4" rx="1" fill="#F3F4F6"/>
          <rect x="12" y="11" width="16" height="20" rx="2.5" fill="#1F2937"/>
          <path d="M15 22 L18.5 25.5 L25 17.5" stroke="#E3A857" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>

        <div class="leading-tight">
          <div class="text-sm font-semibold tracking-wide">
            <span class="text-desertGold">AZ</span>
            <span class="text-white ml-1">Film</span>
            <span class="text-sunsetRed ml-1">Credit</span>
          </div>
          <div class="text-[10px] uppercase tracking-[0.18em] text-gray-400">
            CPA-Ready Prep Service
          </div>
        </div>
      </a>

      <div class="text-xs text-gray-300">
        Need help? <a href="support.html" class="text-desertGold hover:underline">Contact support</a>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="flex-1 py-10">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 grid lg:grid-cols-[2fr,1.2fr] gap-8">

      <!-- LEFT: FORM -->
      <section class="space-y-6">
        <div>
          <h1 class="text-2xl sm:text-3xl font-semibold text-white">
            Submit your project for a CPA-ready Arizona film credit package
          </h1>
          <p class="mt-2 text-sm text-gray-300 max-w-2xl">
            Choose <span class="font-semibold text-desertGold">$39.99 document prep</span> or
            <span class="font-semibold text-desertGold">$39.99 + $399</span> for prep plus a
            Certified AZ CPA review & sign-off.
          </p>
        </div>

        <form id="azfc-processing-form" class="space-y-5">
          <!-- Company + Contact -->
          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-xs text-gray-300 mb-1">Production company name</label>
              <input type="text" name="company_name" required
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
                placeholder="e.g., VIM Media LLC" />
            </div>
            <div>
              <label class="block text-xs text-gray-300 mb-1">Primary contact name</label>
              <input type="text" name="contact_name" required
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
                placeholder="Your name" />
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-xs text-gray-300 mb-1">Contact email</label>
              <input type="email" name="contact_email" required
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
                placeholder="you@example.com" />
            </div>
            <div>
              <label class="block text-xs text-gray-300 mb-1">Contact phone (optional)</label>
              <input type="tel" name="contact_phone"
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
                placeholder="(xxx) xxx-xxxx" />
            </div>
          </div>

          <!-- Project -->
          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-xs text-gray-300 mb-1">Project title</label>
              <input type="text" name="project_title" required
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
                placeholder="e.g., Almost Us" />
            </div>
            <div>
              <label class="block text-xs text-gray-300 mb-1">Project type</label>
              <select name="project_type"
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold">
                <option>Feature film</option>
                <option>TV series / episodic</option>
                <option>Documentary</option>
                <option>Commercial / branded</option>
                <option>Music video</option>
                <option>Other</option>
              </select>
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-xs text-gray-300 mb-1">ACA pre-approval / project ID (optional)</label>
              <input type="text" name="aca_id"
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
                placeholder="Enter ACA ID" />
            </div>
            <div>
              <label class="block text-xs text-gray-300 mb-1">Estimated qualified production costs (optional)</label>
              <input type="number" name="est_qualified_costs" min="0"
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
                placeholder="e.g., 500000" />
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-xs text-gray-300 mb-1">Production start date (optional)</label>
              <input type="date" name="prod_start"
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold" />
            </div>
            <div>
              <label class="block text-xs text-gray-300 mb-1">Production completion date (optional)</label>
              <input type="date" name="prod_end"
                class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold" />
            </div>
          </div>

          <!-- Uploads (MVP UI only; backend file handling comes next) -->
          <div class="space-y-3">
            <p class="text-xs font-semibold text-desertGold uppercase tracking-[0.16em]">
              Upload your production data
            </p>

            <div>
              <label class="block text-xs text-gray-300 mb-1">Master ledger / cost report (CSV / Excel / PDF)</label>
              <input type="file" name="ledger_file" accept=".csv,.xlsx,.xls,.pdf" required
                class="block w-full text-xs text-gray-300 file:mr-2 file:py-1.5 file:px-3 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-desertGold file:text-black hover:file:bg-yellow-400" />
            </div>

            <div>
              <label class="block text-xs text-gray-300 mb-1">Payroll reports (optional)</label>
              <input type="file" name="payroll_files" multiple accept=".csv,.xlsx,.xls,.pdf"
                class="block w-full text-xs text-gray-300 file:mr-2 file:py-1.5 file:px-3 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-desertGold file:text-black hover:file:bg-yellow-400" />
            </div>

            <div>
              <label class="block text-xs text-gray-300 mb-1">Receipts, invoices & contracts (optional)</label>
              <input type="file" name="supporting_docs" multiple accept=".zip,.pdf,.jpg,.jpeg,.png"
                class="block w-full text-xs text-gray-300 file:mr-2 file:py-1.5 file:px-3 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-desertGold file:text-black hover:file:bg-yellow-400" />
              <p class="mt-1 text-[11px] text-gray-400">Tip: If you have many receipts, compress into a single .zip.</p>
            </div>
          </div>

          <!-- Plan -->
          <div class="space-y-2">
            <label class="block text-xs text-gray-300 mb-1">Choose your service</label>
            <div class="bg-white/5 border border-white/10 rounded-lg divide-y divide-white/10">
              <label class="flex items-center justify-between px-3 py-2 text-xs cursor-pointer">
                <span>
                  <span class="font-semibold text-gray-100">Document prep only</span>
                  <span class="block text-[11px] text-gray-400">
                    We organize your package for your own CPA to review and sign.
                  </span>
                </span>
                <span class="flex items-center gap-2">
                  <span class="text-sm font-semibold text-desertGold">$39.99</span>
                  <input type="radio" name="service_plan" value="prep" checked
                    class="w-4 h-4 rounded border-white/40 bg-black/60 text-desertGold focus:ring-desertGold" />
                </span>
              </label>

              <label class="flex items-center justify-between px-3 py-2 text-xs cursor-pointer">
                <span>
                  <span class="font-semibold text-gray-100">Document prep + Certified AZ CPA sign-off</span>
                  <span class="block text-[11px] text-gray-400">
                    We prep your docs and route to a Certified AZ CPA to review and sign.
                  </span>
                </span>
                <span class="flex items-center gap-2">
                  <span class="text-sm font-semibold text-desertGold">$438.99</span>
                  <input type="radio" name="service_plan" value="prep_cpa"
                    class="w-4 h-4 rounded border-white/40 bg-black/60 text-desertGold focus:ring-desertGold" />
                </span>
              </label>
            </div>
          </div>

          <!-- Notes -->
          <div>
            <label class="block text-xs text-gray-300 mb-1">Notes (optional)</label>
            <textarea name="notes" rows="3"
              class="w-full px-3 py-2 rounded-lg bg-black/60 border border-white/15 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-desertGold"
              placeholder="Any unusual items or instructions for the prep team / CPA."></textarea>
          </div>

          <!-- Consent + Price + CTA -->
          <div class="space-y-3">
            <label class="flex items-start gap-2 text-[11px] text-gray-300">
              <input type="checkbox" name="acknowledge" required
                class="mt-[2px] rounded border-white/30 bg-black/60 text-desertGold focus:ring-desertGold" />
              <span>
                I understand AZ Film Credit provides document organization and prep only. A licensed CPA reviews and signs the final audit documentation.
                This is not legal or tax advice.
              </span>
            </label>

            <div class="flex items-center justify-between text-xs text-gray-300 bg-white/5 border border-white/10 rounded-lg px-3 py-2">
              <span>Selected service total:</span>
              <span class="text-base font-semibold text-desertGold" id="price-amount">$39.99</span>
            </div>

            <p class="text-[11px] text-gray-400">
              Payment is processed through our secure in-house gateway. (MVP backend is now wired.)
            </p>

            <div class="flex flex-wrap items-center justify-between gap-3">
              <p id="form-message" class="text-[11px] text-gray-300"></p>

              <button type="button" id="azfc-pay-btn"
                class="inline-flex items-center px-5 py-2.5 rounded-full text-sm font-semibold bg-sunsetRed hover:bg-orange-500 text-white shadow-lg shadow-orange-500/30 transition disabled:opacity-50 disabled:cursor-not-allowed">
                Complete secure payment
              </button>
            </div>
          </div>
        </form>
      </section>

      <!-- RIGHT: SUMMARY -->
      <aside class="space-y-4">
        <div class="bg-white/5 border border-white/10 rounded-xl p-4">
          <h2 class="text-sm font-semibold text-white mb-2">What we generate for your CPA</h2>
          <p class="text-[11px] text-gray-300 mb-3">
            A structured package your Arizona-licensed CPA can review and certify for the Arizona film credit program.
          </p>
          <ul class="text-[11px] text-gray-200 space-y-1.5">
            <li>• <span class="font-semibold">AZ-FC-01</span> – Project Profile</li>
            <li>• <span class="font-semibold">AZ-FC-02</span> – Cost Summary (Qualified vs Non-Qualified)</li>
            <li>• <span class="font-semibold">AZ-FC-03</span> – Arizona Resident Labor Schedule</li>
            <li>• <span class="font-semibold">AZ-FC-04</span> – Vendor & Location Summary</li>
            <li>• <span class="font-semibold">AZ-FC-05</span> – Production Period Statement</li>
            <li>• <span class="font-semibold">AZ-FC-06</span> – Detailed Ledger (Itemized)</li>
            <li>• <span class="font-semibold">AZ-FC-07</span> – Supporting Documentation Index</li>
            <li>• <span class="font-semibold">AZ-FC-08</span> – CPA Certification Draft</li>
          </ul>
        </div>

        <div class="bg-black/60 border border-desertGold/40 rounded-xl p-4">
          <h3 class="text-sm font-semibold text-desertGold mb-1">Plan overview</h3>
          <ul class="text-[11px] text-gray-200 space-y-1.5">
            <li>• <span class="font-semibold">Document prep – $39.99</span><br/>You deliver the CPA-ready package to your CPA.</li>
            <li>• <span class="font-semibold">Prep + Certified AZ CPA – $438.99</span><br/>We prep + route to a Certified AZ CPA for review/sign.</li>
          </ul>
        </div>

        <div class="bg-white/5 border border-white/10 rounded-xl p-4">
          <h3 class="text-sm font-semibold text-white mb-1">Important</h3>
          <p class="text-[11px] text-gray-300">
            AZ Film Credit is an independent prep tool and is not an official product of any government agency.
            Always confirm current program rules and forms with your CPA.
          </p>
        </div>
      </aside>
    </div>

    <!-- SAMPLE CPA AUDIT FLIPBOOK VIEWER -->
    <section class="mt-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-lg sm:text-xl font-semibold text-white mb-1">
        Preview a sample CPA-ready audit package
      </h2>
      <p class="text-[11px] sm:text-xs text-gray-300 mb-4 max-w-3xl">
        Fictional samples showing the structure and detail your CPA receives. Use the tabs to switch sample type.
      </p>

      <div class="flex flex-wrap gap-2 mb-4 text-[11px] sm:text-xs">
        <button class="px-3 py-1 rounded-full bg-white/10 text-desertGold" data-sample="feature">Feature Film</button>
        <button class="px-3 py-1 rounded-full bg-white/5 text-gray-200" data-sample="series">Series</button>
        <button class="px-3 py-1 rounded-full bg-white/5 text-gray-200" data-sample="commercial">Commercial</button>
        <button class="px-3 py-1 rounded-full bg-white/5 text-gray-200" data-sample="music">Music Video</button>
      </div>

      <div class="w-full aspect-[4/3] bg-black/60 border border-white/10 rounded-xl overflow-hidden shadow-xl shadow-black/40">
        <iframe
          id="sample-viewer"
          src="/samples/AZ_Film_Credit_Full_CPA_Audit_Sample_Feature.pdf#view=FitH&page=1"
          class="w-full h-full"
          style="border:0;"
          title="AZ Film Credit Sample Viewer"
        ></iframe>
      </div>

      <div class="mt-3 flex flex-wrap items-center justify-between gap-2 text-[11px]">
        <p class="text-gray-400">
          This sample is for demonstration only and is not a real CPA opinion or official filing.
        </p>
        <a
          id="sample-download-link"
          href="/samples/AZ_Film_Credit_Full_CPA_Audit_Sample_Feature.pdf"
          class="text-desertGold underline underline-offset-2"
          target="_blank"
        >
          Download this sample as PDF
        </a>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="border-t border-white/10 py-4 text-[11px] text-gray-400">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col sm:flex-row items-center justify-between gap-2">
      <div>© <span id="year"></span> AZ Film Credit. All rights reserved.</div>
      <div class="flex gap-4">
        <a href="privacy.html" class="hover:text-desertGold">Privacy</a>
        <a href="terms.html" class="hover:text-desertGold">Terms</a>
        <a href="support.html" class="hover:text-desertGold">Support</a>
      </div>
    </div>
  </footer>

  <script>
    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();

    // Pricing
    const PLAN_PRICES = { prep: 39.99, prep_cpa: 438.99 };

    function getSelectedPlan() {
      const radio = document.querySelector('input[name="service_plan"]:checked');
      return radio ? radio.value : "prep";
    }

    function updatePriceDisplay() {
      const plan = getSelectedPlan();
      const amount = PLAN_PRICES[plan] ?? PLAN_PRICES.prep;
      document.getElementById("price-amount").textContent = `$${amount.toFixed(2)}`;
    }
    document.querySelectorAll('input[name="service_plan"]').forEach(r => r.addEventListener("change", updatePriceDisplay));
    updatePriceDisplay();

    // Flipbook samples
    const azfcSampleMap = {
      feature: "/samples/AZ_Film_Credit_Full_CPA_Audit_Sample_Feature.pdf",
      series: "/samples/AZ_Film_Credit_Full_CPA_Audit_Sample_Series.pdf",
      commercial: "/samples/AZ_Film_Credit_Full_CPA_Audit_Sample_Commercial.pdf",
      music: "/samples/AZ_Film_Credit_Full_CPA_Audit_Sample_MusicVideo.pdf"
    };
    const azfcViewer = document.getElementById("sample-viewer");
    const azfcDownloadLink = document.getElementById("sample-download-link");
    const azfcButtons = document.querySelectorAll("[data-sample]");

    azfcButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const key = btn.getAttribute("data-sample");
        const pdfUrl = azfcSampleMap[key];
        azfcViewer.src = pdfUrl + "#view=FitH&page=1";
        azfcDownloadLink.href = pdfUrl;

        azfcButtons.forEach(b => {
          b.classList.remove("bg-white/10", "text-desertGold");
          b.classList.add("bg-white/5", "text-gray-200");
        });
        btn.classList.add("bg-white/10", "text-desertGold");
        btn.classList.remove("text-gray-200");
      });
    });

    // Form validation (basic MVP)
    function validateForm() {
      const form = document.getElementById("azfc-processing-form");
      const msg = document.getElementById("form-message");
      const requiredFields = form.querySelectorAll("[required]");

      for (const field of requiredFields) {
        if (field.type === "checkbox" && !field.checked) {
          field.scrollIntoView({ behavior: "smooth", block: "center" });
          field.focus();
          msg.textContent = "Please accept the acknowledgement before payment.";
          return false;
        }
        if (field.type === "file") {
          if (!field.files || field.files.length === 0) {
            field.scrollIntoView({ behavior: "smooth", block: "center" });
            field.focus();
            msg.textContent = "Please upload your master ledger / cost report before payment.";
            return false;
          }
        } else if (!field.value) {
          field.scrollIntoView({ behavior: "smooth", block: "center" });
          field.focus();
          msg.textContent = "Please complete all required fields before payment.";
          return false;
        }
      }
      msg.textContent = "";
      return true;
    }

    async function handlePayment() {
      if (!validateForm()) return;

      const payBtn = document.getElementById("azfc-pay-btn");
      const msg = document.getElementById("form-message");
      const form = document.getElementById("azfc-processing-form");
      const formData = new FormData(form);

      const plan = getSelectedPlan();
      const amount = PLAN_PRICES[plan] ?? PLAN_PRICES.prep;

      // Note: This MVP sends ONLY metadata; file upload + processing comes next.
      const payload = {
        service_plan: plan,
        amount,
        company_name: formData.get("company_name"),
        contact_name: formData.get("contact_name"),
        contact_email: formData.get("contact_email"),
        contact_phone: formData.get("contact_phone"),
        project_title: formData.get("project_title"),
        project_type: formData.get("project_type"),
        aca_id: formData.get("aca_id"),
        est_qualified_costs: formData.get("est_qualified_costs"),
        prod_start: formData.get("prod_start"),
        prod_end: formData.get("prod_end"),
        notes: formData.get("notes")
      };

      try {
        payBtn.disabled = true;
        msg.textContent = "Processing… creating your tracking number.";

        const response = await fetch("/api/checkout", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await response.json();
        if (!response.ok || !data.success) {
          throw new Error(data?.message || "Checkout failed");
        }

        // Redirect to thank-you using backend-provided URL if present
        const redirectUrl = data.redirect || `/thank-you.html?tracking=${encodeURIComponent(data.trackingNumber)}&plan=${encodeURIComponent(plan)}`;
        window.location.href = redirectUrl;

      } catch (err) {
        console.error(err);
        msg.textContent = "Payment/checkout failed. Please try again or contact support.";
      } finally {
        payBtn.disabled = false;
      }
    }

    document.getElementById("azfc-pay-btn").addEventListener("click", handlePayment);
  </script>
</body>
</html>
